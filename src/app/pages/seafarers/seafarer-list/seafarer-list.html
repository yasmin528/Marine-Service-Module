<h2 class="text-2xl font-bold text-gray-800 mb-4">Seafarers Roster</h2>

<div class="mb-4 flex flex-wrap items-center gap-2">
  <button id="add-seafarer-btn" (click)="openAddSeafarerForm()"
    class="bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 flex items-center gap-2">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
      <path fill-rule="evenodd"
        d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd">
      </path>
    </svg>
    Add Seafarer
  </button>
  <button id="toggle-seafarer-filter-btn" (click)="openFilter()"
    class="bg-white text-gray-700 px-4 py-2 rounded-lg shadow border border-gray-300 hover:bg-gray-50 flex items-center gap-2">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
      <path fill-rule="evenodd"
        d="M3 3a1 1 0 011-1h12a1 1 0 011 1v3a1 1 0 01-.293.707L12 11.414V15a1 1 0 01-.293.707l-2 2A1 1 0 018 17v-5.586L3.293 6.707A1 1 0 013 6V3z"
        clip-rule="evenodd"></path>
    </svg>
    Filter
  </button>
  <button id="display-seafarer-cols-btn" (click)="OpenDisplayColumns()"
    class="bg-white text-gray-700 px-4 py-2 rounded-lg shadow border border-gray-300 hover:bg-gray-50 flex items-center gap-2">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
        d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V7a2 2 0 012-2h10a2 2 0 012 2v8a2 2 0 01-2 2z"></path>
    </svg>
    Display Columns
  </button>
</div>
<div id="seafarer-filter-panel" class="bg-gray-50 p-4 rounded-lg mb-4" *ngIf="isFilterOpen">
  <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4">
    <input type="text" id="seafarer-rank-filter" placeholder="Filter by Name or Rank..." class="p-2 border rounded-md">
    <input type="text" id="seafarer-nationality-filter" placeholder="Filter by Nationality..."
      class="p-2 border rounded-md">
  </div>
</div>

<div class="bg-white rounded-lg shadow overflow-x-auto">
  <table class="w-full whitespace-nowrap">
    <thead class="bg-gray-50 border-b border-gray-200">
      <tr>
        <th *ngFor="let col of tableColumns"
          class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
          [hidden]="!isColumnVisible(col.key)">
          {{ col.label }}
        </th>
        <th></th>
      </tr>
    </thead>

    <tbody class="divide-y divide-gray-200">


      <tr *ngFor="let s of seafarers()">
        <td *ngFor="let col of tableColumns" [hidden]="!col.selected" class="px-6 py-4 text-sm text-gray-700"
          [hidden]="!isColumnVisible(col.key)">
          {{ getSeafarerValue(s, col.key) }}
        </td>
        <td class="px-6 py-4 text-sm text-gray-700">
          <div class="flex items-center gap-x-3">
            <button data-action="edit-seafarer" data-id="SF001" class="text-blue-600 hover:text-blue-900"
              (click)="isEdit(s)" title="Edit"><svg xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5 pointer-events-none" viewBox="0 0 20 20" fill="currentColor">
                <path d="M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z"></path>
                <path fill-rule="evenodd"
                  d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z"
                  clip-rule="evenodd"></path>
              </svg></button>
            <button data-action="inactive-seafarer" data-id="SF001" class="text-yellow-600 hover:text-yellow-900"
              title="Inactive"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 pointer-events-none"
                viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z"
                  clip-rule="evenodd"></path>
              </svg></button>
            <button
              [ngClass]="{'text-green-600 hover:text-green-900': s.Status === 1, 'text-yellow-600 hover:text-yellow-900': s.Status === 0}"
              (click)="toggleSeafarerStatus(s.Id, s.EmpId, s.Status)" [title]="s.Status === 1 ? 'Active' : 'Inactive'">
              <svg *ngIf="s.Status === 1" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 pointer-events-none"
                viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd"
                  d="M16.707 5.293a1 1 0 00-1.414 0L9 11.586 6.707 9.293a1 1 0 00-1.414 1.414l3 3a1 1 0 001.414 0l7-7a1 1 0 000-1.414z"
                  clip-rule="evenodd" />
              </svg>
              <svg *ngIf="s.Status === 2" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 pointer-events-none"
                viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M7 9a1 1 0 000 2h6a1 1 0 100-2H7z" clip-rule="evenodd" />
              </svg>
            </button>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<!-- addform -->
<app-Modal [hidden]="!isSeafarerFormOpen" title="Add Seafarer">
  <app-seafarer-form (closeForm)="isSeafarerFormOpen = false" [editData]="selectedSeafarer"></app-seafarer-form>
</app-Modal>

<!-- Column Display Panel -->
<div id="column-display-panel" class="fixed inset-0 bg-black bg-opacity-50 z-40 flex items-center justify-center p-4"
  *ngIf="isDisplayColumnsOpen">
  <div class="bg-white rounded-lg shadow-xl w-full max-w-md m-4">
    <div class="p-6 border-b">
      <h3 class="text-lg font-medium">Display Columns</h3>
    </div>

    <div class="p-6 grid grid-cols-2 sm:grid-cols-3 gap-4 max-h-96 overflow-y-auto custom-scrollbar">
      <label *ngFor="let col of tableColumns" class="flex items-center space-x-3">
        <input type="checkbox" [checked]="col.selected" (change)="toggleColumn(col)"
          class="column-toggle h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
        <span class="text-gray-700 text-sm">{{ col.label }}</span>
      </label>
    </div>

    <div class="px-6 py-4 bg-gray-50 flex justify-end">
      <button (click)="closePanel()"
        class="px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700">Close</button>
    </div>
  </div>
</div>

<!-- add-display-row -->
<app-column-panel *ngIf="isDisplayColumnsOpen" [columns]="tableColumns" (selectionChange)="onColumnPanelChange($event)"
  (close)="isDisplayColumnsOpen = false">
</app-column-panel>
