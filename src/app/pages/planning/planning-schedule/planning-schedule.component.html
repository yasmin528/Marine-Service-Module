<div id="planning-content" class="tab-content">
  <div class="bg-white rounded-lg shadow h-full flex flex-col">
    <!-- Header -->
    <div class="p-4 border-b flex flex-wrap gap-4 justify-between items-center">
      <div class="flex items-center gap-4">
        <button id="back-to-vessel-list-btn" class="p-2 hover:bg-gray-100 rounded-md" (click)="backToVesselList()">
          <svg class="h-5 w-5 text-gray-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
            stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"></path>
          </svg>
        </button>
        <h2 class="text-lg font-bold text-gray-800">{{vessel()?.name}}</h2>
      </div>
      <div class="flex items-center gap-2">
        <button class="px-4 py-2 text-sm font-medium bg-blue-600 text-white rounded-md shadow">Seafarers</button>
        <button
          class="px-4 py-2 text-sm font-medium bg-white text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50 shadow">Positions</button>
      </div>
    </div>

    <!-- Main Content -->
    <div id="planning-scroll-container" class="flex-1 overflow-auto custom-scrollbar cursor-grab">
      <div class="p-4">
        <button id="add-planning-assignment-btn"
          class="bg-white text-blue-600 border border-blue-500 px-3 py-1.5 rounded-lg shadow-sm hover:bg-blue-50 text-sm font-medium">
          Add seafarer
        </button>
      </div>
      <div class="relative">
        <!-- Timeline Header -->
        <div class="sticky top-0 bg-white z-10 grid grid-cols-[150px_1fr] border-b-2 border-gray-300 min-w-[1200px]">
          <div class="p-2 border-r border-gray-200"></div>
          <div class="grid grid-cols-12">
            <div class="p-2 text-center text-xs font-semibold text-gray-500 border-r border-gray-200">Jan</div>
            <div class="p-2 text-center text-xs font-semibold text-gray-500 border-r border-gray-200">Feb</div>
            <div class="p-2 text-center text-xs font-semibold text-gray-500 border-r border-gray-200">Mar</div>
            <div class="p-2 text-center text-xs font-semibold text-gray-500 border-r border-gray-200">Apr</div>
            <div class="p-2 text-center text-xs font-semibold text-gray-500 border-r border-gray-200">May</div>
            <div class="p-2 text-center text-xs font-semibold text-gray-500 border-r border-gray-200">Jun</div>
            <div class="p-2 text-center text-xs font-semibold text-gray-500 border-r border-gray-200">Jul</div>
            <div class="p-2 text-center text-xs font-semibold text-gray-500 border-r border-gray-200">Aug</div>
            <div class="p-2 text-center text-xs font-semibold text-gray-500 border-r border-gray-200">Sep</div>
            <div class="p-2 text-center text-xs font-semibold text-gray-500 border-r border-gray-200">Oct</div>
            <div class="p-2 text-center text-xs font-semibold text-gray-500 border-r border-gray-200">Nov</div>
            <div class="p-2 text-center text-xs font-semibold text-gray-500 border-r border-gray-200">Dec</div>
          </div>
        </div>
        <!-- Timeline Body -->
        <div id="timeline-body" class="relative">

          <div class="grid grid-cols-[150px_1fr] border-t border-gray-200 min-w-[1200px]"
            *ngFor="let rank of vesselPlanning()?.ranks" [attr.data-rank]="rank">
            <div
              class="p-2 border-r border-gray-200 text-sm font-medium text-gray-600 flex items-center whitespace-nowrap">
              {{ rank }}
            </div>
            <div class="relative border-r border-gray-200 h-10 timeline-row">

              <div *ngFor="let assignment of getAssignmentsByRank(rank)"
                class="absolute top-2 h-6 rounded-md px-2 text-white text-xs flex items-center overflow-hidden cursor-pointer"
                [ngClass]="assignment.color" [style.left.%]="calculateLeft(assignment.startDate!)"
                [style.width.%]="calculateWidth(assignment.startDate!, assignment.endDate!)"
                [attr.data-assignment-id]="assignment.id" [attr.data-start-date]="assignment.startDate"
                [attr.data-end-date]="assignment.endDate"
                [title]="assignment.seafarerName + ' (' + assignment.startDate + ' to ' + assignment.endDate + ')'"
                draggable="true" (dragstart)="onDragStart($event, assignment.id)" (dragend)="onDragEnd($event)">
                <span class="whitespace-nowrap truncate">{{ assignment.seafarerName }}</span>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
