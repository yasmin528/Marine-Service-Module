<div id="payroll-content" class="tab-content">
  <div class="bg-white rounded-lg shadow h-full flex flex-col">
    <!-- Header -->
    <div class="p-4 border-b flex flex-wrap gap-4 justify-between items-center">
      <h2 class="text-xl font-bold text-gray-800">Payroll Records</h2>
      <div class="flex items-center gap-4">
        <select class="p-2 border rounded-md" [formControl]="selectedMonth">
          <option *ngFor="let month of months" [value]="month">{{ month }}</option>
        </select>
        <select class="p-2 border rounded-md" [formControl]="selectedVessel">
          <option *ngFor="let vessel of vessels" [value]="vessel">{{ vessel }}</option>
        </select>
        <button (click)="exportPayroll()"
          class="bg-green-600 text-white px-4 py-2 rounded-lg shadow hover:bg-green-700 flex items-center gap-2">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd"
              d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z"
              clip-rule="evenodd" /></svg>
          Export
        </button>
      </div>
    </div>

    <!-- Payroll Table -->
    <div class="flex-1 overflow-auto custom-scrollbar">
      <table class="w-full whitespace-nowrap">
        <thead class="bg-gray-50 border-b border-gray-200 sticky top-0">
          <tr>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Rank</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Vessel</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Period</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Salary</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Allowances</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Deductions</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Net Pay</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-gray-200">
          <tr *ngFor="let record of filteredRecords">
            <td class="px-6 py-4 text-sm font-medium text-gray-900">{{ record.name }}</td>
            <td class="px-6 py-4 text-sm text-gray-500">{{ record.rank }}</td>
            <td class="px-6 py-4 text-sm text-gray-500">{{ record.vessel }}</td>
            <td class="px-6 py-4 text-sm text-gray-500">{{ record.period }}</td>
            <td class="px-6 py-4 text-sm text-gray-500">${{ record.salary | number }}</td>
            <td class="px-6 py-4 text-sm text-gray-500">${{ record.allowances | number }}</td>
            <td class="px-6 py-4 text-sm text-gray-500">${{ record.deductions | number }}</td>
            <td class="px-6 py-4 text-sm font-semibold text-gray-900">${{ record.netPay | number }}</td>
            <td class="px-6 py-4 text-sm">
              <span
                [ngClass]="record.status === 'Paid' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'"
                class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full">
                {{ record.status }}
              </span>
            </td>
            <td class="px-6 py-4 text-sm">
              <div class="flex items-center gap-x-3">
                <button (click)="alert('Viewing payslip for ' + record.name)" class="text-blue-600 hover:text-blue-900"
                  title="View Payslip">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M10 12a2 2 0 100-4 2 2 0 000 4z" />
                    <path fill-rule="evenodd"
                      d="M.458 10C3.732 4.943 9.522 3 10 3s6.268 1.943 9.542 7c-3.274 5.057-9.064 7-9.542 7S3.732 15.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z"
                      clip-rule="evenodd" /></svg>
                </button>
                <button *ngIf="record.status === 'Pending'" (click)="updatePayrollStatus(record, 'Paid')"
                  title="Approve Payment" class="text-green-600 hover:text-green-900"><svg
                    xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd"
                      d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                      clip-rule="evenodd" /></svg></button>
              </div>
            </td>
          </tr>
          <tr *ngIf="filteredRecords.length === 0">
            <td colspan="10" class="px-6 py-4 text-center text-gray-500">No payroll records found for the selected
              filters.</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
